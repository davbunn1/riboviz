# How To Run the Riboviz Interactive Data Visualization On Your Data

This page describes how to generate and run an interactive shiny app to visualize and explore your data after running the RiboViz workflow. RiboViz has an integrated, but optional data visualization tool written in `R` and using `shiny`. The script is located at `rscripts/run_shiny_server.R` and takes a single mandatory argument - a YAML file, and one optional argument - a port number for port forwarding. The YAML file is not the original configuration file used for a RiboViz run, but instead is generated by running the RiboViz workflow, called `interactive_viz_config.yaml` which will be located in your output folder (`dir_out`) after running RiboViz.

## Activating the shiny server on a local machine

To use the visualization tool, you can enter the following command at the command line. If you're outside of `riboviz/rscripts`, then you'll need to provide the full path to the `run_shiny_server.R` script.
```
Rscript --vanilla run_shiny_server.R path/to/interactive_viz_config.yaml
```

Once entered, the command will print out the something like the following
```
"Listening on http://127.0.0.1:4254"
```

The IP address provided can simply be pasted into a web browser's URL bar and will direct you to the shiny server which is now hosted from the local machine.

## Activating the shiny server on a headless machine

If you're running on a headless machine like a server, the shiny server will be hosted on said server. By default, the shiny server is sent to port `4254`. If this port is open, then the same command as above will allow you to access the shiny server. Alternatively, you can specify a port at the command line as in the following example which uses port `1234`.
```
Rscript --vanilla run_shiny_server.R path/to/interactive_viz_config.yaml 1234
```

## Description of tabs

You can choose which samples you would like to view by checking the appropriate boxes at the top of the screen. Changes are not submitted until you press the `Apply Changes` button, after which the shiny app refreshes the interactive plots with your chosen selections.

### Read count summary

This tab displays a bar graph showing the number reads over the course of the processing steps.

### TPM summary

This tab displays a heatmap with sample to sample pairwise correlations based on $log_{10}(TPM)$ as well as TPM density plots showing the distribution of TPMs for each gene. This tab allows you to enter the name of a gene from your data, doing so will draw a vertical black line on the density plots to show you where that gene lies among the distribution of TPMs.

### Read length distributions

This tab displays read length distributions.

### 3nt periodicity

This tab displays graphs related to the positioning and the frame of the reads.

### Normalized reads by position

This tab displays the normalized read coverage around start and stop sites in each of the samples.

### Gene specific coverage

This displays read distributions for each codon along a single gene. Reads from each frame are summed to give a single number for each codon and plotted. The user can select the gene and region within that gene to view.

### Ribogrid

This tab displays a meta-feature plot called a ribogrid, The user can select the read lengths and positions they wish to view. Bar graph versions of the ribogrids are shown below.

### Features

This tab displays scatterplots of TPMs versus other features of the genome such as GC content, transcript length, or other features. The user can select which features to graph against. This plot is only possible when the user has supplied a features file.
